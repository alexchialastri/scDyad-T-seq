#The shell scripts are used to create reports and finalized datasets from raw sequencing data in Dyad-seq. Use the proper shell script based on the sequencing library performed. These shell scripts use custom perlscripts along with open source software and basic linux commands.
	Shell scripts used to detect differing marks

sc_CpG-Dyad.sh - Is used to detect fully or hemi-methylated CpGs when performing M-M-Dyad-seq, M-H-Dyad-seq or scDyad-seq.

sc_5hmCpG-Dyad.sh - Is used to detect fully or hemi-methylation CpGs when performing H-H-Dyad-seq or H-M Dyad-seq
The main difference between these two files is the use of MspJI or AbaSI for detection.

sc_BS_CpG_Diad_SE_BothEnds.sh - Is used to detect absolute 5mC or 5hmC levels when performing M-M-Dyad-seq, M-H-Dyad-seq or scDyad-seq.

sc_BS_5hmCpG_Diad_SE_BothEnds.sh - Is used to detect absolute 5mC or 5hmC levels when performing H-H-Dyad-seq or H-M Dyad-seq.
The main difference between these scripts is the barcodes used when performing the assay with MspJI or AbaSI.

sc_mRNA_NOVOGENE_FQ_Analysis_Using_STAR_mm10.sh - Is the shell script used to align single-cell transcriptomic data using STAR aligner.

#These shell scripts require the barcodes for each sequencing type, the files to these are below
	Cell Barcode Files
cel-seq_barcode_whitelist - Contains RNA barcodes ordered by cell number (for use in scDyad&T-seq)

AbaSI_5hmC_CpGDyad_SingleCell_Barcodes.txt - contains H-H-Dyad-seq and H-M-Dyad-seq barcodes ordered by cell number.

5mCpGDiadSingleCellBarcodes.txt - contains M-H-Dyad-seq and M-M-Dyad-seq and scDyad&T-seq barcodes ordered by cell number.

#These are perl scripts called within the shell scripts.

MakeFastqShorter.pl - Used to hard clip Fastq files
Argument 0 = Input Fastq file name
Argument 1 = Desired Output Fastq file name
Argument 2 = Desired Fastq file trimmed length

scCpGDiad_Trim_and_ExtractBarcodes_se-HammingCorrection.pl - Used to identify reads with the proper PCR sequence "GGTGTAGTGGGTTTGG" and proper barcodes.
Argument 0 = Barcode list
Argument 1 = Input Fastq file
Argument 2 = UMI length (Typically 4 for most experiments performed in manuscript)

process_scCpGDiadwithQC.pl - Searches the genome location of mapped reads to identify fully or hemi-methylated CpG or CpH sites. Also detects all 5mC calls inferred by the cutting action of MspJI.
Argument 0 = Genome used for mapping (non bisulfite converted)
Argument 1 = Mapped deduplicated sam file from Bismark
Argument 2 = Cell barcodes used for M-M-Dyad-seq, M-H-Dyad-seq or scDyad-seq.
Argument 3 = UMI length used (typically = 4)

Pullout-scMaintainedCGandCHG.pl - Summarizes the detection per cell. Resulting .fabaMaintained text file gives the cell number, the number of fully methylated detections, the number of hemimethylated detections, and the percent fully methylated for CpG sites followed by CpHpG sites in the next 3 columns.
Argument 0 = .faba file generated by the process_scCpGDiadwithQC.pl script.

FabaToCGtxt.pl - Takes .faba file and creates a CpG maintained (fully methylated) and non-maintained files (hemi-methylated) text files. The exact loci of the CpG site is modified slightly from the faba file to correct for which strand it was detected on. These resulting files are used in downstream analysis and are submitted on GEO.
Argument 0 = .faba file generated by the process_scCpGDiadwithQC.pl script.

Reads_Per_Cell_Count.pl - summarizes the number of 5mC detections inferred MspJI. This value is always greater than the number of CpG sites detected with maintenance information, and accounts for detections in non CpG context as well.
Argument 0 = .faba file generated by the process_scCpGDiadwithQC.pl script.

process_sc5hmC_CpGDiad.pl - Searches the genome location of mapped reads to identify fully or hemi-hydroxymethylated CpG sites. Also detects all 5hmC calls inferred by the cutting action of AbaSI.
Argument 0 = Genome used for mapping (non bisulfite converted)
Argument 1 = Mapped deduplicated sam file from Bismark
Argument 2 = Cell barcodes used for H-M-Dyad-seq, H-H-Dyad-seq.
Argument 3 = UMI length used (typically = 4)

Pullout-scMaintainedCG_ForAbaSI.pl - Summarizes the detection per cell. Resulting .fabaMaintained text file gives the cell number, the number of fully hydroxymethylated detections, the number of hemi-hydroxymethylated detections, and the percent fully hydroxymethylated for CpG sites.
Argument 0 = .faba file generated by the process_sc5hmC_CpGDiad.pl script.

AbaSIFabaToCGtxt.pl - Takes .faba file and creates a CpG hydroxymaintained (fully hydroxymethylated) and non-maintained files (hemi-hydroxymethylated) text files. These resulting files are used in downstream analysis and are submitted on GEO.
Argument 0 = .faba file generated by the process_sc5hmC_CpGDiad.pl script.

scCpGDiad_Trim_and_ExtractBarcodes_se-HammingCorrection_TransferToR2.pl - Used to identify reads with the proper PCR sequence "GGTGTAGTGGGTTTGG" and proper barcodes. Also concatenates the UMI and cell barcode to the read name for read1 and 2
Argument 0 = Barcode list
Argument 1 = Read 1 Input Fastq file
Argument 2 = UMI length (Typically 4 for most experiments performed in manuscript)
Argument 3 = Read 2 Input Fastq file

MethylationConcordanceScoring.pl -
Argument 0 = Mapped deduplicated sam file from Bismark
Argument 1 = Barcode list
Argument 2 = UMI length (typically = 4)
Argument 3 = SpikeInFlag (typically = 2, genome only)
Argument 4 = Number of CpGs needed on a single read (typically = 5)
Argument 5 = Percent threshold to call read as fully methylated (typically = 90)
Argument 6 = Percent threshold to call read as fully unmethylated (typically = 10)

Pullout-scMethylationFromBismarkMethylationExtractor_wReadNames.pl - Reformats the Bismark Methylation Extractor format to demultiplex by cell barcode and UMI.
Argument 0 = Bismark Methylation Extractor text file. There are 8 options. [CpG_OB_*txt, CpG_CTOB_*txt, CpG_OT_*txt, CpG_CTOT_*txt, Non_CpG_OB_*txt, Non_CpG_CTOB_*txt, Non_CpG_OT_*txt, Non_CpG_CTOT_*txt]. Run this script on each of the Bismark Methylation Extractor output files.
Argument 1 = Barcode list
Argument 2 = UMI length (typically = 4)

Reads_Per_Cell_Count_BismarkZorz.pl - summarizes the count detection per cell as two output files in order by cell number. Number of methylated 5mCpGs found or number of unmethylated CpGs found.
Argument 0 = Text file containing 6 columns space delimited (cell chr loci strand UMI MethCall{Z,z})

Reads_Per_Cell_Count_Bismark_NonCGMethCount.pl - summarizes the count detection per cell as two output files in order by cell number. Number of methylated non CpG 5mCs found or number of unmethylated non CpG cytosine found.
Argument 0 = Text file containing 6 columns space delimited (cell chr loci strand UMI MethCall{XH,xh})

Meth_Percent_PerCell_BS.pl - Summarizes all strands together. Inputs are *MethylatedCountsPerCell.txt files. Can be used on CpG or nonCpG files. Results in a file with two columns describing the total detection of sites and percent methylated of sites per cell, in order of cell number.
Argument 0 = *_OB_MethylatedCountsPerCell.txt
Argument 1 = *OB_UnmethylatedCountsPerCell.txt
Argument 2 = *OT_MethylatedCountsPerCell.txt
Argument 3 = *OT_UnmethylatedCountsPerCell.txt
Argument 4 = Desired output file name.

Binning_MouseGenomeForStrandBias_BS.pl - Takes 5mC calls for all cells and demultiplexes the cells as well as counts detection in each bin of the genome of a user defined size. Results in 3 files, the number of methylated calls in the bin by cell, the number of unmethylated calls in the bin by cell, and the resulting division of these two tables aka the percent methylation of each bin by cell. This script would need some modification for non mouse genomes.
Argument 0 = Text file containing 6 columns space delimited (cell chr loci strand UMI MethCall{Z,z}) typically all sites detected combined on all strands after deduplication.
Argument 1 = Bin size
